---
# title: "Consultoria & Solu√ß√µes"
# subtitle: "An√°lises estat√≠sticas rigorosas para academia e mercado"
page-layout: full
title-block-banner: false
include-in-header:
- text: |
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <style>
        .mermaid { margin: 0 auto; text-align: center; }
        .mermaid svg { max-width: 100%; height: auto; }
      </style>
# - text: |
#     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
#     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
#- text: |
#      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
#      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
#      <style>
#        .mermaid { margin: 0 auto; text-align: center; }
#        /* Garante que o diagrama n√£o fique espremido no celular */
#        .mermaid svg { min-width: 800px; max-width: 100%; height: auto; }
#        .mermaid-scroll { overflow-x: auto; padding-bottom: 10px; }
#      </style>
---

## Servi√ßos de Consultoria Estat√≠stica

::: {style="text-align: justify; margin-top: 15px; margin-bottom: 40px; font-size: 1.1em; line-height: 1.8;"}

A **ŒõŒ£ Consultoria** oferece suporte t√©cnico especializado para transformar dados complexos em resultados claros, an√°lises estat√≠sticas rigorosas para academia e mercado, atuando na fronteira entre a teoria estat√≠stica e a aplica√ß√£o pr√°tica.

- **Acad√™mico:** Suporte metodol√≥gico em **an√°lises estat√≠sticas** para Pesquisas (TCCs, Disserta√ß√µes e Teses), com foco em reprodutibilidade e rigor cient√≠fico.

- **Corporativo:** Intelig√™ncia de dados, modelagem preditiva e an√°lise de cen√°rios para embasar tomadas de decis√£o cr√≠ticas.

:::

## Vamos tirar seu projeto do papel?

```{=html}
<div style="text-align: center; margin-top: 30px; margin-bottom: 30px;">
  <h3 style="font-weight: 900; color: #2a2a2a;">Nossa Metodologia de Trabalho</h3>
  <p style="color: #666;">Transpar√™ncia do in√≠cio ao fim do projeto</p>
</div>
```


<div class="mermaid-scroll">
```{mermaid}
%%| fig-align: center
%%| fig-height: 6
flowchart TD
    A['<i class="fa-solid fa-file-pen"></i> 1. Solicita√ß√£o'] --> B['<i class="fa-brands fa-whatsapp"></i> 2. Contato √Ågil']
    B --> C['<i class="fa-solid fa-handshake"></i> 3. Reuni√£o']
    C --> D['<i class="fa-solid fa-file-invoice-dollar"></i> 4. Proposta Comercial']
    D --> E['<i class="fa-solid fa-laptop-code"></i> 5. Desenvolvimento']
    E --> F['<i class="fa-solid fa-rocket"></i> 6. Entrega Final']

   %% Estilo Premium: Fundos claros para o processo e cores ricas para in√≠cio/fim
   classDef start fill:#18bc9c,stroke:#2ecc71,color:#fff,stroke-width:5px,font-weight:900,rx:15,ry:15;
   classDef process fill:#f5f5f5,stroke:#e0e0e0,color:#34495e,stroke-width:2px,font-weight:600,rx:15,ry:15;
   classDef endNode fill:#34495e,stroke:#2c3e50,color:#fff,stroke-width:5px,font-weight:900,rx:15,ry:15;

   class A start;
   class B,C,D,E process;
   class F endNode;

   %% Setas grossas e escuras  
   linkStyle default stroke:#555,stroke-width:3px;
   linkStyle 0 stroke:#18bc9c; 
   linkStyle 4 stroke:#34495e;
```

</div>


::: {style="text-align: justify; margin-top: 30px; margin-top: 30px; margin-bottom: 20px; font-size: 1.1em;"}

Preencha o formul√°rio abaixo para uma an√°lise preliminar. Respondemos rapidamente.
:::

```{=html}
<div class="form-container">

  <div id="success-message" style="display:none; text-align: center; background: rgba(255,255,255,0.95); padding: 50px; border-radius: 20px; border: 1px solid #18bc9c; box-shadow: 0 10px 30px rgba(0,0,0,0.05); width: 100%;">
    <i class="fa-solid fa-circle-check" style="font-size: 5em; color: #18bc9c; margin-bottom: 20px;"></i>
    <h2 style="color: #2a2a2a; margin-bottom: 10px; font-weight: 700;">Mensagem Recebida!</h2>
    <p style="color: #555; font-size: 1.1em; margin-bottom: 5px;">Obrigado, <strong><span id="user-name-display"></span></strong>.</p>
    <p style="color: #666; line-height: 1.6;">Recebemos seus arquivos e detalhes.<br>Entraremos em contato <strong>o mais breve poss√≠vel</strong> para agendar uma reuni√£o.</p>
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #eee; font-size: 0.9em; color: #888;">
      <i class="fa-brands fa-whatsapp"></i> Fique atento ao seu WhatsApp.
    </div>
    <button onclick="location.reload()" class="button1" style="margin-top: 30px; max-width: 250px; background-color: #333;">Voltar ao In√≠cio</button>
  </div>

  <form id="contact-form" class="form" action="https://formsubmit.co/ajax/alexssandrosg@gmail.com" method="POST" enctype="multipart/form-data">
    
    <input type="hidden" name="_subject" value="[Nome] - Nova Oportunidade (Consultoria)">
    <input type="hidden" name="_template" value="table">
    <input type="hidden" name="_captcha" value="false">
    
    <input type="hidden" name="_next" id="next-url" value="">

    <p id="heading">Fale Conosco</p>
    
    <div class="field">
      <i class="fa-solid fa-user input-icon"></i>
      <input autocomplete="off" name="Nome" id="input-nome" placeholder="Seu Nome Completo *" class="input-field" type="text" required>
    </div>

    <div class="field">
      <i class="fa-solid fa-envelope input-icon"></i>
      <input autocomplete="off" name="Email" id="input-email" placeholder="Seu Melhor E-mail *" class="input-field" type="email" required>
    </div>

    <div class="field" style="border-left: 4px solid #18bc9c;"> 
      <i class="fa-brands fa-whatsapp input-icon" style="color: #18bc9c;"></i>
      <input autocomplete="off" name="WhatsApp" id="input-whatsapp" placeholder="WhatsApp (DDD + N√∫mero)" class="input-field" type="tel">
    </div>
    
    <div style="display: flex; align-items: start; gap: 10px; margin-top: -8px; margin-bottom: 15px; padding-left: 5px;">
      <input type="checkbox" name="Permissao_WhatsApp" id="zap-check" checked style="margin-top: 5px; accent-color: #18bc9c; cursor: pointer;">
      <label for="zap-check" style="font-size: 0.8em; color: #666; cursor: pointer; line-height: 1.4;">
        Autorizo o contato via WhatsApp para agilizar o atendimento.
      </label>
    </div>

    <div class="field">
      <i class="fa-solid fa-bullseye input-icon"></i>
      <input autocomplete="off" name="Assunto" placeholder="Assunto (ex: An√°lise TCC, Dashboards Corporativos)" class="input-field" type="text">
    </div>

    <div class="field" style="align-items: flex-start;">
      <i class="fa-solid fa-align-left input-icon" style="margin-top: 8px;"></i>
      <textarea name="Mensagem" placeholder="Descreva brevemente o objetivo do projeto..." class="input-field"></textarea>
    </div>

    <div class="field" style="flex-direction: column; align-items: flex-start;">
      <div style="display: flex; width: 100%; align-items: center; gap: 10px;">
        <i class="fa-solid fa-folder-open input-icon"></i>
        <input type="file" id="file-upload" name="Arquivo" class="input-field" accept=".pdf,.doc,.docx,.xlsx,.csv,.txt,.R,.Rmd" multiple>
      </div>
      <div id="file-feedback" style="font-size: 0.85em; color: #2a2a2a; margin-top: 5px; padding-left: 30px; font-weight: 500;"></div>
    </div>
    
    <div style="font-size: 0.75em; color: #999; margin-top: -10px; margin-bottom: 5px; padding-left: 10px; font-style: italic;">
      * Recomendamos enviar amostras dos dados ou resumo do projeto.
    </div>

    <div class="btn-submit" style="flex-direction: column; align-items: center; gap: 15px;">
      <button type="submit" class="button1" id="submit-btn">
        <i class="fa-solid fa-paper-plane" style="margin-right: 8px;"></i> Solicitar An√°lise do Projeto
      </button>
      <span style="font-size: 0.8em; color: #888; font-weight: 500;">
        <i class="fa-solid fa-clock" style="color: #18bc9c;"></i> Atendimento Seg. a Dom. | Resposta R√°pida
      </span>
    </div>

  </form>
</div>

<script>
  const form = document.getElementById('contact-form');
  const successMessage = document.getElementById('success-message');
  const userNameDisplay = document.getElementById('user-name-display');
  const submitBtn = document.getElementById('submit-btn');
  const fileInput = document.getElementById('file-upload');
  const fileFeedback = document.getElementById('file-feedback');

  // --- CONFIGURA√á√ÉO AUTOM√ÅTICA DE REDIRECIONAMENTO ---
  document.getElementById('next-url').value = window.location.href;

  // 1. Mostrar nomes dos arquivos selecionados
  fileInput.addEventListener('change', function() {
    if (this.files && this.files.length > 0) {
      let fileNames = Array.from(this.files).map(f => f.name).join(', ');
      fileFeedback.innerHTML = `<i class="fa-solid fa-check" style="color:#18bc9c;"></i> <strong>${this.files.length} arquivo(s):</strong> <br><span style="color:#555; font-size:0.9em;">${fileNames}</span>`;
    } else {
      fileFeedback.innerHTML = "";
    }
  });

  // 2. Valida√ß√£o e Envio
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Valida√ß√µes
    const emailField = document.getElementById('input-email');
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailField.value)) {
        alert("Por favor, insira um e-mail v√°lido.");
        emailField.focus(); return;
    }

    const whatsField = document.getElementById('input-whatsapp');
    const whatsValue = whatsField.value.replace(/\D/g, ''); 
    if (whatsValue.length > 0 && (whatsValue.length < 10 || whatsValue.length > 11)) {
        alert("O n√∫mero de WhatsApp parece incompleto. Use DDD + N√∫mero.");
        whatsField.focus(); return;
    }
    
    // Preparar Envio
    const originalBtnText = submitBtn.innerHTML;
    submitBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Enviando...';
    submitBtn.style.opacity = "0.7";
    submitBtn.disabled = true;

    // Obt√©m o primeiro nome para a mensagem de sucesso
    const nome = document.getElementById('input-nome').value.split(' ')[0];
    
    // üî¥ FIX: Trata envio com arquivos. Exibe a mensagem de sucesso E for√ßa o envio tradicional
    if (fileInput.files && fileInput.files.length > 0) {
        
        // 1. Exibe a mensagem de sucesso (simula√ß√£o) IMEDIATAMENTE antes do envio
        userNameDisplay.innerText = nome;
        $(form).fadeOut(500, function() { $(successMessage).fadeIn(500); });
        $('html, body').animate({ scrollTop: $(".form-container").offset().top - 100 }, 800);
        
        // 2. Garante o envio tradicional (Plano B)
        console.warn("Arquivos detectados. For√ßando exibi√ß√£o de sucesso e envio tradicional.");
        
        // Remove listener e define a a√ß√£o para o modo tradicional (sem /ajax)
        form.removeEventListener('submit', arguments.callee);
        form.action = "https://formsubmit.co/alexssandrosg@gmail.com"; 
        
        // 3. Aguarda um momento para a anima√ß√£o de fadeOut e envia o formul√°rio no modo tradicional
        setTimeout(() => {
            form.submit();
        }, 1000); // D√° 1 segundo para o usu√°rio ver a mensagem antes de recarregar
        
        return; 
    }

    // --- Se N√ÉO houver arquivos, continua com o AJAX (Envio Silencioso) ---
    const formData = new FormData(form);

    fetch("https://formsubmit.co/ajax/alexssandrosg@gmail.com", {
      method: "POST",
      headers: { 'Accept': 'application/json' },
      body: formData
    })
    .then(response => {
        if (!response.ok) { throw new Error('Falha AJAX'); }
        return response.json();
    })
    .then(data => {
      // Sucesso AJAX (Aparece a mensagem verde sem recarregar)
      console.log("Sucesso:", data);
      userNameDisplay.innerText = nome;
      $(form).fadeOut(500, function() { $(successMessage).fadeIn(500); });
      $('html, body').animate({ scrollTop: $(".form-container").offset().top - 100 }, 800);
    })
    .catch(error => {
      // Falha AJAX (Plano B Gen√©rico, se falhar mesmo sem arquivo)
      console.warn("Erro AJAX, tentando fallback:", error);
      
      form.removeEventListener('submit', arguments.callee);
      form.action = "https://formsubmit.co/alexssandrosg@gmail.com";
      form.submit();
    });
  });
</script>
```

